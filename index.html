<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="google-adsense-account" content="ca-pub-7201410532556676" />
  <title>오늘의 운세 · 로또 추첨 · 메뉴 추천 · 동물상 테스트</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="오늘의 운세, 로또 번호 추천, 메뉴 추천, 동물상 테스트까지 한 번에 즐길 수 있는 엔터테인먼트 사이트입니다." />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7201410532556676"
     crossorigin="anonymous"></script>

  <style>
    @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css");
    @import url("https://fonts.googleapis.com/css2?family=Sora:wght@500;600;700&display=swap");

    :root {
      --bg: #0b1020;
      --card: #141b2d;
      --card-2: #0f172a;
      --card-border: rgba(148,163,184,.18);
      --text: #e2e8f0;
      --muted: #94a3b8;
      --accent: #f59e0b;
      --accent-2: #22c55e;
      --primary: linear-gradient(90deg, #f59e0b, #22c55e);
      --bg-grad-1: #0ea5e933;
      --bg-grad-2: #f9731633;
      --btn-sub-bg: #0f172a;
      --btn-sub-text: var(--text);
      --shadow: 0 20px 50px rgba(15,23,42,.35);
    }

    [data-theme="light"] {
      --bg: #f8fafc;
      --card: #ffffff;
      --card-2: #f1f5f9;
      --card-border: rgba(15,23,42,.12);
      --text: #0f172a;
      --muted: #475569;
      --accent: #f97316;
      --accent-2: #0ea5e9;
      --primary: linear-gradient(90deg, #f97316, #0ea5e9);
      --bg-grad-1: #f59e0b22;
      --bg-grad-2: #38bdf822;
      --btn-sub-bg: #ffffff;
      --btn-sub-text: #0f172a;
      --shadow: 0 12px 30px rgba(15,23,42,.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(800px 400px at 15% 0%, var(--bg-grad-1), transparent),
                  radial-gradient(900px 500px at 85% 100%, var(--bg-grad-2), transparent),
                  var(--bg);
      color: var(--text);
      font-family: "Pretendard", "Noto Sans KR", "Apple SD Gothic Neo", sans-serif;
    }

    h1, h2, h3, .brand {
      font-family: "Sora", "Pretendard", "Noto Sans KR", sans-serif;
      margin: 0;
    }

    a { color: inherit; text-decoration: none; }

    .app {
      width: min(1100px, 92vw);
      margin: 0 auto;
      padding: 30px 0 80px;
      display: grid;
      gap: 36px;
    }

    .top-bar {
      margin-top: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 20px 24px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      box-shadow: var(--shadow);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 22px;
      font-weight: 700;
    }

    .brand-badge {
      padding: 6px 12px;
      border-radius: 999px;
      background: var(--primary);
      color: #0b1020;
      font-size: 12px;
      font-weight: 700;
    }

    .hero {
      display: grid;
      grid-template-columns: 1.3fr 1fr;
      gap: 22px;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      padding: 22px;
      box-shadow: var(--shadow);
    }

    .fortune-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 12px;
      font-size: 20px;
      font-weight: 700;
    }

    .fortune-text {
      font-size: 20px;
      line-height: 1.6;
      margin-bottom: 18px;
    }

    .fortune-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 18px;
    }

    .tag {
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--card-2);
      border: 1px solid var(--card-border);
      font-size: 12px;
      color: var(--muted);
    }

    .focus-grid {
      display: grid;
      gap: 14px;
    }

    .focus-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 16px 18px;
      border-radius: 16px;
      background: var(--card);
      border: 1px solid var(--card-border);
    }

    .focus-label {
      font-weight: 700;
    }

    .focus-score {
      font-weight: 900;
      color: var(--accent);
    }

    .section {
      display: grid;
      gap: 16px;
    }

    .section-head h2 {
      font-size: 22px;
    }

    .section-head p {
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 14px;
    }

    .controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    .btn-main {
      flex: 1;
      padding: 14px 20px;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      font-weight: 900;
      font-size: 15px;
      background: var(--primary);
      color: #0b1020;
      box-shadow: 0 10px 30px rgba(15,23,42,.25);
    }

    .btn-sub {
      padding: 12px 16px;
      border-radius: 14px;
      border: 1px solid var(--card-border);
      background: var(--btn-sub-bg);
      color: var(--btn-sub-text);
      cursor: pointer;
      font-weight: 600;
    }

    .lang-select {
      appearance: none;
      padding: 12px 36px 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--card-border);
      background: var(--btn-sub-bg);
      color: var(--btn-sub-text);
      font-weight: 600;
      cursor: pointer;
      background-image: linear-gradient(45deg, transparent 50%, var(--btn-sub-text) 50%),
                        linear-gradient(135deg, var(--btn-sub-text) 50%, transparent 50%);
      background-position: calc(100% - 18px) 18px, calc(100% - 12px) 18px;
      background-size: 6px 6px, 6px 6px;
      background-repeat: no-repeat;
    }

    .select-field {
      appearance: none;
      padding: 12px 36px 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--card-border);
      background: var(--btn-sub-bg);
      color: var(--btn-sub-text);
      font-weight: 600;
      cursor: pointer;
      background-image: linear-gradient(45deg, transparent 50%, var(--btn-sub-text) 50%),
                        linear-gradient(135deg, var(--btn-sub-text) 50%, transparent 50%);
      background-position: calc(100% - 18px) 18px, calc(100% - 12px) 18px;
      background-size: 6px 6px, 6px 6px;
      background-repeat: no-repeat;
    }

    .fortune-controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    .fortune-controls .btn-main {
      flex: 0 0 auto;
    }

    .checkbox {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 14px;
      color: var(--muted);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }

    .game-card {
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 16px;
    }

    .game-header {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .numbers {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .plus {
      color: var(--muted);
      font-weight: 900;
      margin: 0 4px;
    }

    .ball {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: grid;
      place-items: center;
      font-weight: 900;
      font-size: 14px;
      color: #0b1020;
    }

    .n1 { background: #facc15; }
    .n2 { background: #60a5fa; }
    .n3 { background: #fb7185; }
    .n4 { background: #a3a3a3; }
    .n5 { background: #4ade80; }
    .bonus { background: #a855f7; color: #fff; }

    .footer {
      text-align: center;
      font-size: 13px;
      color: var(--muted);
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
    }

    .menu-card {
      padding: 18px;
      border-radius: 18px;
      background: var(--card);
      border: 1px solid var(--card-border);
      display: grid;
      gap: 8px;
    }

    .menu-thumb {
      width: 100%;
      height: 140px;
      object-fit: cover;
      border-radius: 14px;
      border: 1px solid var(--card-border);
      background: var(--card-2);
    }

    .menu-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .menu-link {
      width: fit-content;
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: var(--btn-sub-bg);
      color: var(--btn-sub-text);
      font-weight: 700;
    }

    .menu-alert {
      border-style: dashed;
      background: var(--card-2);
    }

    .menu-card h3 {
      font-size: 18px;
    }

    .menu-card p {
      margin: 0;
      color: var(--muted);
      font-size: 13px;
    }

    .site-footer {
      margin-top: 20px;
      padding: 18px 20px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 18px;
      display: grid;
      gap: 10px;
      color: var(--muted);
      font-size: 13px;
    }

    .footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-weight: 600;
      color: var(--text);
    }

    .footer-links a {
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--card-2);
      border: 1px solid var(--card-border);
    }

    .form-grid {
      display: grid;
      gap: 14px;
    }

    .field {
      display: grid;
      gap: 8px;
    }

    .field label {
      font-size: 13px;
      color: var(--muted);
    }

    .field input,
    .field textarea {
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: var(--card-2);
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
    }

    .field textarea {
      min-height: 120px;
      resize: vertical;
    }

    @media (max-width: 900px) {
      .hero { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<main class="app" id="home">
  <header class="top-bar">
    <div class="brand">
      <span class="brand-badge" data-i18n="badge_today">오늘</span>
      <span data-i18n="brand_title">오늘의 운세</span>
    </div>
    <div>
      <a class="btn-sub" href="animal.html" data-i18n="nav_animal">동물상 테스트</a>
      <a class="btn-sub" href="about.html" data-i18n="nav_about">사이트 소개</a>
      <select id="langSelect" class="lang-select" aria-label="Language selector">
        <option value="ko">한국어</option>
        <option value="en">English</option>
      </select>
      <button id="themeToggle" class="btn-sub" type="button">Dark</button>
    </div>
  </header>

  <section class="hero">
    <div class="card">
      <div class="fortune-title">
        <h1 data-i18n="fortune_title">??? ??? ??</h1>
        <span class="tag" data-i18n="fortune_tag">??? ???</span>
      </div>
      <div id="fortuneText" class="fortune-text"></div>
      <div id="fortuneTags" class="fortune-tags"></div>
      <div class="fortune-controls">
        <select id="zodiacSelect" class="select-field" aria-label="Zodiac selector"></select>
        <button id="zodiacBtn" class="btn-main" type="button" data-i18n="fortune_btn">?? ????</button>
      </div>
    </div>

    <div class="focus-grid">
      <div class="focus-item">
        <div>
          <div class="focus-label" data-i18n="focus_love_label">연애운</div>
          <div class="tag" data-i18n="focus_love_tag">대화가 길을 연다</div>
        </div>
        <div class="focus-score">87</div>
      </div>
      <div class="focus-item">
        <div>
          <div class="focus-label" data-i18n="focus_money_label">금전운</div>
          <div class="tag" data-i18n="focus_money_tag">지출 전에 한 번 더</div>
        </div>
        <div class="focus-score">72</div>
      </div>
      <div class="focus-item">
        <div>
          <div class="focus-label" data-i18n="focus_health_label">건강운</div>
          <div class="tag" data-i18n="focus_health_tag">짧은 스트레칭</div>
        </div>
        <div class="focus-score">90</div>
      </div>
    </div>
  </section>

  <section class="section" id="lotto">
    <div class="section-head">
      <h2 data-i18n="lotto_title">로또 추첨</h2>
      <p data-i18n="lotto_desc">버튼을 누르면 1~45 사이에서 중복 없이 6개 번호를 5게임 한 번에 뽑아줘요.</p>
    </div>

    <div class="controls">
      <button id="pickBtn" class="btn-main" data-i18n="lotto_pick">5게임 추천 받기</button>
      <button id="copyBtn" class="btn-sub" data-i18n="lotto_copy">전체 복사</button>
      <label class="checkbox">
        <input type="checkbox" id="bonusCheck" checked />
        <span data-i18n="lotto_bonus">보너스 번호 포함</span>
      </label>
    </div>

    <div id="grid" class="grid"></div>
    <div id="footer" class="footer"></div>
  </section>

  <section class="section" id="menu">
    <div class="section-head">
      <h2 data-i18n="menu_title">오늘의 메뉴 추천</h2>
      <p data-i18n="menu_desc">TheMealDB 레시피에서 오늘의 메뉴를 랜덤 추천해요. 마음에 드는 메뉴를 골라보세요.</p>
    </div>

    <div class="controls">
      <button id="menuPickBtn" class="btn-sub" type="button" data-i18n="menu_reroll">다시 추천하기</button>
    </div>

    <div id="menuGrid" class="menu-grid"></div>
  </section>

  <section class="section" id="note">
    <div class="section-head">
      <h2 data-i18n="note_title">오늘의 큐레이션 노트</h2>
      <p data-i18n="note_desc">운세 문구와 메뉴 추천은 하루의 흐름과 기분을 상상해 만든 오리지널 문장으로 구성돼요.</p>
    </div>
    <div class="card">
      <p data-i18n="note_line_1">오늘의 운세는 “여유, 선택, 전환점” 같은 키워드를 중심으로 매일 다른 문장을 구성합니다.</p>
      <p data-i18n="note_line_2">메뉴 추천은 계절·컨디션·기분의 조합을 기준으로 제안하고 있으며, 요청이 많은 메뉴는 주기적으로 반영합니다.</p>
    </div>
  </section>

  <section class="section" id="contact">
    <div class="section-head">
      <h2 data-i18n="contact_title">재휴 문의</h2>
      <p data-i18n="contact_desc">간단한 정보만 남겨주시면 빠르게 연락드릴게요.</p>
    </div>

    <form class="card form-grid" action="https://formspree.io/f/xgokpwwl" method="POST">
      <div class="field">
        <label for="name" data-i18n="contact_name_label">이름</label>
        <input id="name" name="name" type="text" placeholder="홍길동" data-i18n-placeholder="contact_name_placeholder" required />
      </div>
      <div class="field">
        <label for="email" data-i18n="contact_email_label">이메일</label>
        <input id="email" name="email" type="email" placeholder="name@example.com" required />
      </div>
      <div class="field">
        <label for="message" data-i18n="contact_message_label">문의 내용</label>
        <textarea id="message" name="message" placeholder="문의 내용을 입력해주세요." data-i18n-placeholder="contact_message_placeholder" required></textarea>
      </div>
      <button class="btn-main" type="submit" data-i18n="contact_submit">문의 보내기</button>
    </form>
  </section>

  <footer class="site-footer">
    <div class="footer-links">
      <a href="about.html" data-i18n="footer_about">사이트 소개</a>
      <a href="privacy.html" data-i18n="footer_privacy">개인정보 처리방침</a>
      <a href="terms.html" data-i18n="footer_terms">이용약관</a>
      <a href="menu-request.html" data-i18n="footer_menu_request">메뉴 추가 요청</a>
    </div>
    <div data-i18n="footer_contact_note">문의는 재휴 문의 폼을 통해 접수하고 있습니다.</div>
    <div data-i18n="footer_copyright">© 2026 TodayLab. All rights reserved.</div>
  </footer>
</main>

<script>
  const grid = document.getElementById("grid");
  const footer = document.getElementById("footer");
  const bonusCheck = document.getElementById("bonusCheck");
  const themeToggle = document.getElementById("themeToggle");
  const themeRoot = document.documentElement;
  const fortuneText = document.getElementById("fortuneText");
  const fortuneTags = document.getElementById("fortuneTags");
  const zodiacBtn = document.getElementById("zodiacBtn");
  const zodiacSelect = document.getElementById("zodiacSelect");
  const menuGrid = document.getElementById("menuGrid");
  const menuPickBtn = document.getElementById("menuPickBtn");
  const langSelect = document.getElementById("langSelect");

  const i18n = {
    ko: {
      title: "오늘의 운세 · 로또 추첨 · 메뉴 추천 · 동물상 테스트",
      description: "오늘의 운세, 로또 번호 추천, 메뉴 추천, 동물상 테스트까지 한 번에 즐길 수 있는 엔터테인먼트 사이트입니다.",
      badge_today: "오늘",
      brand_title: "오늘의 운세",
      nav_animal: "동물상 테스트",
      nav_about: "사이트 소개",
      fortune_title: "??? ??? ??",
      fortune_tag: "??? ???",
      fortune_btn: "?? ????",
      zodiac_loading: "??? ??? ???? ?...",
      zodiac_error: "??? ??? ???? ????. ?? ? ?? ??? ???.",
      zodiac_compatibility: "??",
      zodiac_lucky_number: "?? ??",
      zodiac_lucky_time: "?? ??",
      zodiac_color: "?? ??",
      zodiac_mood: "??? ??",
      zodiac_sign: "???",
      zodiac_range: "??",
      focus_love_label: "연애운",
      focus_love_tag: "대화가 길을 연다",
      focus_money_label: "금전운",
      focus_money_tag: "지출 전에 한 번 더",
      focus_health_label: "건강운",
      focus_health_tag: "짧은 스트레칭",
      lotto_title: "로또 추첨",
      lotto_desc: "버튼을 누르면 1~45 사이에서 중복 없이 6개 번호를 5게임 한 번에 뽑아줘요.",
      lotto_pick: "5게임 추천 받기",
      lotto_copy: "전체 복사",
      lotto_bonus: "보너스 번호 포함",
      menu_title: "오늘의 메뉴 추천",
      menu_desc: "TheMealDB 레시피에서 오늘의 메뉴를 랜덤 추천해요. 마음에 드는 메뉴를 골라보세요.",
      menu_reroll: "다시 추천하기",
      menu_loading: "레시피 불러오는 중...",
      menu_error: "레시피를 불러오지 못해 기본 추천으로 대체했어요.",
      menu_source: "레시피 보기",
      note_title: "오늘의 큐레이션 노트",
      note_desc: "운세 문구와 메뉴 추천은 하루의 흐름과 기분을 상상해 만든 오리지널 문장으로 구성돼요.",
      note_line_1: "오늘의 운세는 “여유, 선택, 전환점” 같은 키워드를 중심으로 매일 다른 문장을 구성합니다.",
      note_line_2: "메뉴 추천은 계절·컨디션·기분의 조합을 기준으로 제안하고 있으며, 요청이 많은 메뉴는 주기적으로 반영합니다.",
      contact_title: "재휴 문의",
      contact_desc: "간단한 정보만 남겨주시면 빠르게 연락드릴게요.",
      contact_name_label: "이름",
      contact_name_placeholder: "홍길동",
      contact_email_label: "이메일",
      contact_message_label: "문의 내용",
      contact_message_placeholder: "문의 내용을 입력해주세요.",
      contact_submit: "문의 보내기",
      footer_about: "사이트 소개",
      footer_privacy: "개인정보 처리방침",
      footer_terms: "이용약관",
      footer_menu_request: "메뉴 추가 요청",
      footer_contact_note: "문의는 재휴 문의 폼을 통해 접수하고 있습니다.",
      footer_copyright: "© 2026 TodayLab. All rights reserved.",
      theme_light: "Light",
      theme_dark: "Dark",
      game_label: "게임",
      bonus_label: "보너스 포함",
      complete_label: "추천 완료",
      total_games: "총 5게임",
      copy_success: "전체 번호를 복사했어요."
    },
    en: {
      title: "Today Fortune · Lotto Picks · Menu Picks · Animal Face Test",
      description: "A fun hub for daily fortune, lotto numbers, menu picks, and animal-face test in one place.",
      badge_today: "Today",
      brand_title: "Today's Fortune",
      nav_animal: "Animal Face Test",
      nav_about: "About",
      fortune_title: "Today's Zodiac Horoscope",
      fortune_tag: "Zodiac Guide",
      fortune_btn: "Get Horoscope",
      zodiac_loading: "Loading your horoscope...",
      zodiac_error: "Unable to load the horoscope. Please try again.",
      zodiac_compatibility: "Compatibility",
      zodiac_lucky_number: "Lucky number",
      zodiac_lucky_time: "Lucky time",
      zodiac_color: "Lucky color",
      zodiac_mood: "Today's mood",
      zodiac_sign: "Zodiac",
      zodiac_range: "Date range",
      focus_love_label: "Love",
      focus_love_tag: "Conversation opens doors",
      focus_money_label: "Money",
      focus_money_tag: "Pause before spending",
      focus_health_label: "Health",
      focus_health_tag: "Short stretches help",
      lotto_title: "Lotto Picks",
      lotto_desc: "Tap the button to draw 5 games of 6 numbers between 1 and 45 without duplicates.",
      lotto_pick: "Get 5 Picks",
      lotto_copy: "Copy All",
      lotto_bonus: "Include bonus number",
      menu_title: "Today's Menu Picks",
      menu_desc: "Random picks powered by TheMealDB recipes. Choose one for today.",
      menu_reroll: "Pick Again",
      menu_loading: "Loading recipes...",
      menu_error: "Couldn't reach the recipe API, showing fallback picks.",
      menu_source: "View recipe",
      note_title: "Curation Note",
      note_desc: "Fortunes and menu picks are crafted as original copy inspired by the day's mood.",
      note_line_1: "Daily fortunes rotate around themes like ease, choice, and turning points.",
      note_line_2: "Menu picks are based on season, condition, and mood, and popular requests get updated regularly.",
      contact_title: "Partnership Inquiry",
      contact_desc: "Leave a short note and we will get back to you soon.",
      contact_name_label: "Name",
      contact_name_placeholder: "Your name",
      contact_email_label: "Email",
      contact_message_label: "Message",
      contact_message_placeholder: "Tell us about your inquiry.",
      contact_submit: "Send Inquiry",
      footer_about: "About",
      footer_privacy: "Privacy Policy",
      footer_terms: "Terms",
      footer_menu_request: "Menu Request",
      footer_contact_note: "Please submit inquiries via the partnership form.",
      footer_copyright: "© 2026 TodayLab. All rights reserved.",
      theme_light: "Light",
      theme_dark: "Dark",
      game_label: "Game",
      bonus_label: "Bonus included",
      complete_label: "Completed",
      total_games: "Total 5 games",
      copy_success: "All numbers copied."
    }
  };

  let currentLang = localStorage.getItem("lang") || "ko";

  const zodiacSigns = [
    { value: "aries", ko: "???", en: "Aries" },
    { value: "taurus", ko: "????", en: "Taurus" },
    { value: "gemini", ko: "?????", en: "Gemini" },
    { value: "cancer", ko: "???", en: "Cancer" },
    { value: "leo", ko: "????", en: "Leo" },
    { value: "virgo", ko: "????", en: "Virgo" },
    { value: "libra", ko: "????", en: "Libra" },
    { value: "scorpio", ko: "????", en: "Scorpio" },
    { value: "sagittarius", ko: "????", en: "Sagittarius" },
    { value: "capricorn", ko: "????", en: "Capricorn" },
    { value: "aquarius", ko: "????", en: "Aquarius" },
    { value: "pisces", ko: "?????", en: "Pisces" }
  ];

  const ASTRO_ENDPOINT = "https://aztro.sameerkumar.website/";

  const fallbackMenuOptions = [
    {
      title: { ko: "?? ???", en: "Spicy Kalguksu" },
      desc: { ko: "???? ?? ??? ? ??? ??? ??.", en: "Warm soup to reset on low-energy days." },
      tag: { ko: "???", en: "Warm" }
    },
    {
      title: { ko: "?? ??", en: "Salmon Poke" },
      desc: { ko: "??? ?? ???? ???? ? ???.", en: "Light but satisfying when you need focus." },
      tag: { ko: "???", en: "Light" }
    },
    {
      title: { ko: "??? ?? ???", en: "Truffle Cream Pasta" },
      desc: { ko: "??? ????? ?? ??? ?? ??.", en: "A small treat for yourself today." },
      tag: { ko: "??", en: "Comfort" }
    },
    {
      title: { ko: "?? ???", en: "Charcoal Dakgalbi" },
      desc: { ko: "???? ??? ? ??? ? ?.", en: "A bold meal when you need energy." },
      tag: { ko: "??", en: "Energy" }
    },
    {
      title: { ko: "?? ?? ???", en: "Shrimp Rose Risotto" },
      desc: { ko: "???? ??? ?? ??? ?? ??.", en: "Creamy with a hint of spice for a mood lift." },
      tag: { ko: "????", en: "Refresh" }
    },
    {
      title: { ko: "??? ???", en: "Bulgogi Bibimbap" },
      desc: { ko: "?? ???? ??? ?? ? ???.", en: "Perfect when you want a hearty bowl." },
      tag: { ko: "???", en: "Hearty" }
    },
    {
      title: { ko: "?? ???", en: "Chicken Salad" },
      desc: { ko: "???? ???? ??? ?? ?.", en: "Light yet protein-rich for balance." },
      tag: { ko: "??", en: "Balance" }
    },
    {
      title: { ko: "?? ????", en: "Spicy Pork Rice Bowl" },
      desc: { ko: "??? ??? ??? ????.", en: "Boost your afternoon with a spicy kick." },
      tag: { ko: "??", en: "Energy" }
    }
  ];

  const MEALDB_RANDOM_ENDPOINT = "https://www.themealdb.com/api/json/v1/1/random.php";

  function escapeHTML(value) {
    return String(value)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#39;");
  }

  function extractIngredients(meal, limit = 4) {
    const ingredients = [];
    for (let i = 1; i <= 20; i++) {
      const value = meal[`strIngredient${i}`];
      if (value && value.trim()) ingredients.push(value.trim());
      if (ingredients.length >= limit) break;
    }
    return ingredients;
  }

  function formatMeal(meal) {
    const ingredients = extractIngredients(meal, 4);
    const tags = [meal.strCategory, meal.strArea].filter(Boolean);
    return {
      title: { ko: meal.strMeal, en: meal.strMeal },
      desc: {
        ko: ingredients.length ? `?? ??: ${ingredients.join(", ")}` : "? ?? ????? ?? ?????.",
        en: ingredients.length ? `Key ingredients: ${ingredients.join(", ")}` : "A recipe worth trying today."
      },
      tags,
      image: meal.strMealThumb || "",
      link: meal.strSource || meal.strYoutube || ""
    };
  }

  async function fetchRandomMeal() {
    const response = await fetch(MEALDB_RANDOM_ENDPOINT);
    if (!response.ok) throw new Error("Meal API error");
    const data = await response.json();
    return data && data.meals ? data.meals[0] : null;
  }

  async function fetchMenuPicks(count = 4) {
    const picks = [];
    const seen = new Set();
    let attempts = 0;

    while (picks.length < count && attempts < count * 3) {
      attempts += 1;
      const meal = await fetchRandomMeal();
      if (!meal || seen.has(meal.idMeal)) continue;
      seen.add(meal.idMeal);
      picks.push(formatMeal(meal));
    }

    return picks;
  }

  function renderMenuCard(item) {
    const title = escapeHTML(item.title[currentLang] || item.title.en || "");
    const desc = escapeHTML(item.desc[currentLang] || item.desc.en || "");
    const tags = item.tags && item.tags.length
      ? item.tags
      : [currentLang === "ko" ? "???" : "Recipe"];
    const imgMarkup = item.image
      ? `<img class="menu-thumb" src="${escapeHTML(item.image)}" alt="${title}" loading="lazy" />`
      : `<div class="menu-thumb"></div>`;
    const tagMarkup = tags
      .map(tag => `<span class="tag">${escapeHTML(tag)}</span>`)
      .join("");
    const linkMarkup = item.link
      ? `<a class="menu-link" href="${escapeHTML(item.link)}" target="_blank" rel="noopener">${i18n[currentLang].menu_source}</a>`
      : "";

    return `
      <div class="menu-card">
        ${imgMarkup}
        <h3>${title}</h3>
        <p>${desc}</p>
        <div class="menu-meta">${tagMarkup}</div>
        ${linkMarkup}
      </div>
    `;
  }

  function applyTheme(theme) {
    if (theme === "light") {
      themeRoot.setAttribute("data-theme", "light");
      themeToggle.textContent = i18n[currentLang].theme_light;
    } else {
      themeRoot.removeAttribute("data-theme");
      themeToggle.textContent = i18n[currentLang].theme_dark;
    }
  }

  function initTheme() {
    const saved = localStorage.getItem("theme");
    if (saved === "light" || saved === "dark") {
      applyTheme(saved);
      return;
    }
    const prefersLight = window.matchMedia &&
      window.matchMedia("(prefers-color-scheme: light)").matches;
    applyTheme(prefersLight ? "light" : "dark");
  }

  function applyLanguage(lang) {
    currentLang = lang;
    localStorage.setItem("lang", lang);
    document.documentElement.setAttribute("lang", lang);
    if (langSelect) langSelect.value = lang;

    document.title = i18n[lang].title;
    const metaDesc = document.querySelector('meta[name="description"]');
    if (metaDesc) metaDesc.setAttribute("content", i18n[lang].description);

    document.querySelectorAll("[data-i18n]").forEach((el) => {
      const key = el.dataset.i18n;
      if (i18n[lang][key]) el.textContent = i18n[lang][key];
    });

    document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
      const key = el.dataset.i18nPlaceholder;
      if (i18n[lang][key]) el.setAttribute("placeholder", i18n[lang][key]);
    });

    const theme = localStorage.getItem("theme");
    if (theme === "light" || theme === "dark") applyTheme(theme);
    renderMenu();
    renderZodiacOptions();
    renderHoroscope();
    renderGames();
  }

  function renderZodiacOptions() {
    if (!zodiacSelect) return;
    const saved = localStorage.getItem("zodiacSign") || zodiacSigns[0].value;
    zodiacSelect.innerHTML = zodiacSigns
      .map(sign => {
        const label = currentLang === "ko" ? sign.ko : sign.en;
        return `<option value="${sign.value}">${label}</option>`;
      })
      .join("");
    zodiacSelect.value = saved;
  }

  function getZodiacLabel(signValue) {
    const sign = zodiacSigns.find(item => item.value === signValue) || zodiacSigns[0];
    return currentLang === "ko" ? sign.ko : sign.en;
  }

  async function fetchHoroscope(sign, day = "today") {
    const url = `${ASTRO_ENDPOINT}?sign=${encodeURIComponent(sign)}&day=${encodeURIComponent(day)}`;
    const response = await fetch(url, { method: "POST" });
    if (!response.ok) throw new Error("Horoscope API error");
    return response.json();
  }

  function renderHoroscopeTags(data, signLabel) {
    const tags = [
      `${i18n[currentLang].zodiac_sign}: ${signLabel}`,
      data.date_range ? `${i18n[currentLang].zodiac_range}: ${data.date_range}` : null,
      data.compatibility ? `${i18n[currentLang].zodiac_compatibility}: ${data.compatibility}` : null,
      data.lucky_number ? `${i18n[currentLang].zodiac_lucky_number}: ${data.lucky_number}` : null,
      data.lucky_time ? `${i18n[currentLang].zodiac_lucky_time}: ${data.lucky_time}` : null,
      data.color ? `${i18n[currentLang].zodiac_color}: ${data.color}` : null,
      data.mood ? `${i18n[currentLang].zodiac_mood}: ${data.mood}` : null
    ].filter(Boolean);

    fortuneTags.innerHTML = tags
      .map(tag => `<span class="tag">${escapeHTML(tag)}</span>`)
      .join("");
  }

  async function renderHoroscope() {
    if (!fortuneText || !fortuneTags) return;
    const signValue = zodiacSelect ? zodiacSelect.value : zodiacSigns[0].value;
    const signLabel = getZodiacLabel(signValue);

    fortuneText.textContent = i18n[currentLang].zodiac_loading;
    fortuneTags.innerHTML = `<span class="tag">${escapeHTML(signLabel)}</span>`;

    try {
      const data = await fetchHoroscope(signValue, "today");
      fortuneText.textContent = data.description || i18n[currentLang].zodiac_error;
      renderHoroscopeTags(data, signLabel);
    } catch (error) {
      fortuneText.textContent = i18n[currentLang].zodiac_error;
      fortuneTags.innerHTML = `<span class="tag">${escapeHTML(signLabel)}</span>`;
    }
  }

  function shuffle(list) {
    const copy = list.slice();
    for (let i = copy.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [copy[i], copy[j]] = [copy[j], copy[i]];
    }
    return copy;
  }

  async function renderMenu() {
    if (!menuGrid) return;

    menuGrid.innerHTML = `
      <div class="menu-card menu-alert">
        <p>${i18n[currentLang].menu_loading}</p>
      </div>
    `;

    let picks = [];
    try {
      picks = await fetchMenuPicks(4);
    } catch (error) {
      picks = [];
    }

    if (!picks.length) {
      const fallback = shuffle(fallbackMenuOptions).slice(0, 4).map(item => ({
        title: item.title,
        desc: item.desc,
        tags: [item.tag[currentLang]],
        image: "",
        link: ""
      }));

      menuGrid.innerHTML = `
        <div class="menu-card menu-alert">
          <p>${i18n[currentLang].menu_error}</p>
        </div>
      ` + fallback.map(renderMenuCard).join("");
      return;
    }

    menuGrid.innerHTML = picks.map(renderMenuCard).join("");
  }


  function colorClass(n) {
    if (n <= 10) return "n1";
    if (n <= 20) return "n2";
    if (n <= 30) return "n3";
    if (n <= 40) return "n4";
    return "n5";
  }

  function pickNumbers(count, exclude = []) {
    const pool = [];
    for (let i = 1; i <= 45; i++) {
      if (!exclude.includes(i)) pool.push(i);
    }
    for (let i = pool.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    return pool.slice(0, count);
  }

  function renderGames() {
    grid.innerHTML = "";

    const allGames = [];

    for (let i = 1; i <= 5; i++) {
      const mainNums = pickNumbers(6).sort((a,b)=>a-b);
      const bonusNum = bonusCheck.checked ? pickNumbers(1, mainNums)[0] : null;

      allGames.push({ mainNums, bonusNum });

      const card = document.createElement("div");
      card.className = "game-card";

      card.innerHTML = `
        <div class="game-header">
          <span>${i18n[currentLang].game_label} ${i}</span>
          <span>${bonusNum ? i18n[currentLang].bonus_label : ""}</span>
        </div>
        <div class="numbers">
          ${mainNums.map(n =>
            `<div class="ball ${colorClass(n)}">${n}</div>`
          ).join("")}
          ${bonusNum ? `<span class="plus">+</span>
            <div class="ball bonus">${bonusNum}</div>` : ""}
        </div>
      `;

      grid.appendChild(card);
    }

    const dateLocale = currentLang === "ko" ? "ko-KR" : "en-US";
    footer.textContent =
      `${i18n[currentLang].complete_label} · ${new Date().toLocaleString(dateLocale)} · ${i18n[currentLang].total_games}`;

    document.getElementById("copyBtn").onclick = () => {
      const text = allGames.map(g =>
        g.mainNums.join(", ") + (g.bonusNum ? ` + ${g.bonusNum}` : "")
      ).join("\n");
      navigator.clipboard.writeText(text);
      alert(i18n[currentLang].copy_success);
    };
  }

  document.getElementById("pickBtn").onclick = renderGames;
  if (zodiacBtn) zodiacBtn.addEventListener("click", renderHoroscope);
  if (zodiacSelect) {
    zodiacSelect.addEventListener("change", (event) => {
      localStorage.setItem("zodiacSign", event.target.value);
      renderHoroscope();
    });
  }
  menuPickBtn.addEventListener("click", renderMenu);

  themeToggle.onclick = () => {
    const isLight = themeRoot.getAttribute("data-theme") === "light";
    const next = isLight ? "dark" : "light";
    applyTheme(next);
    localStorage.setItem("theme", next);
  };

  if (langSelect) {
    langSelect.addEventListener("change", (event) => {
      applyLanguage(event.target.value);
    });
  }

  initTheme();
  applyLanguage(currentLang);
</script>

</body>
</html>
